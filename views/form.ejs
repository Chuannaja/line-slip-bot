<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">

  <h2 class="mb-4">üìù ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô #<%= payment.id %></h2>


  <form method="POST" action="/form/<%= payment.id %>">
	<div class="mb-3">
	  <label class="form-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞</label>
	  <select name="payment_type" class="form-select" required>
		<%- include('partials/payment_options', { payment }) %>
	  </select>
	</div>

    <div class="mb-3">
      <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠</label>
      <input type="text" class="form-control" name="first_name" value="<%= payment.first_name || '' %>" required>
    </div>

    <div class="mb-3">
      <label class="form-label">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
      <input type="text" class="form-control" name="last_name" value="<%= payment.last_name || '' %>" required>
    </div>

    <div class="mb-3">
      <label class="form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
      <input type="text" class="form-control" name="phone" value="<%= payment.phone || '' %>" required>
    </div>
	<div class="mb-3">
	  <label class="form-label">‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</label>
	  <input type="text" class="form-control" id="house_no" name="house_no">
	</div>

	<div class="mb-3">
	  <label class="form-label">‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà</label>
	  <input type="text" class="form-control" id="village_no" name="village_no">
	</div>

<div class="mb-3">
  <label class="form-label">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
  <select class="form-select" id="province" name="province" onchange="loadAmphoe()">
    <option value="‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå" selected>‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå</option>
  </select>
</div>

<div class="mb-3">
  <label class="form-label">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
  <select class="form-select" id="amphoe" name="district" onchange="loadTambon()">
    <option value="‡πÄ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≠" selected>‡πÄ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≠</option>
  </select>
</div>

<div class="mb-3">
  <label class="form-label">‡∏ï‡∏≥‡∏ö‡∏•</label>
  <select class="form-select" id="tambon" name="subdistrict">
    <option value="‡πÄ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≠" selected>‡πÄ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≠</option>
  </select>
</div>


<!-- hidden field ‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô address ‡∏Å‡πà‡∏≠‡∏ô submit -->
<input type="hidden" name="address" id="full_address">


    <div class="mb-3">
      <label class="form-label">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô (OCR ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö)</label>
      <input type="text" class="form-control" value="<%= payment.amount || '‡πÑ‡∏°‡πà‡∏û‡∏ö' %>" readonly>
    </div>

    <% if (payment.slip_url) { %>
      <div class="mb-3">
        <label class="form-label">‡∏™‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î:</label><br>
        <img src="<%= payment.slip_url %>" class="img-fluid rounded border" style="max-width:400px;">
      </div>
    <% } %>	

    <button type="submit" class="btn btn-success">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  </form>

</body>
</html>
<script>
  // ‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (mock data)
  function loadAmphoe() {
    const amphoe = document.getElementById("amphoe");
    amphoe.innerHTML = "";
    const selectedProv = document.getElementById("province").value;

    let list = [];
    if (selectedProv === "‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå") {
      //list = ["‡πÄ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≠", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå", "‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏ö‡∏∏‡∏£‡∏µ"];
	  list = ["‡πÄ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≠"];
    //} else if (selectedProv === "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å") {
    //  list = ["‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å", "‡∏ö‡∏≤‡∏á‡∏£‡∏∞‡∏Å‡∏≥"];
    //} else if (selectedProv === "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£") {
    //  list = ["‡πÄ‡∏Ç‡∏ï‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£", "‡πÄ‡∏Ç‡∏ï‡∏ö‡∏≤‡∏á‡∏Å‡∏∞‡∏õ‡∏¥"];
    }

    amphoe.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ --</option>';
    list.forEach(a => {
      amphoe.innerHTML += `<option value="${a}">${a}</option>`;
    });
  }

  // ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≥‡∏ö‡∏• (mock data)
  function loadTambon() {
    const tambon = document.getElementById("tambon");
    tambon.innerHTML = "";
    const selectedAmphoe = document.getElementById("amphoe").value;

    let list = [];
    if (selectedAmphoe === "‡πÄ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≠") {
      //list = ["‡πÄ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≠", "‡∏£‡∏¥‡∏°‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á", "‡∏™‡∏∞‡πÄ‡∏î‡∏≤‡∏∞‡∏û‡∏á"];
	  list = ["‡πÄ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≠"];
    //} else if (selectedAmphoe === "‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå") {
     // list = ["‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏™‡∏∞‡πÄ‡∏î‡∏µ‡∏¢‡∏á"];
    }

    tambon.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏• --</option>';
    list.forEach(t => {
      tambon.innerHTML += `<option value="${t}">${t}</option>`;
    });
  }

  // ‡∏£‡∏ß‡∏° address ‡∏Å‡πà‡∏≠‡∏ô submit
  document.querySelector("form").addEventListener("submit", function(e) {
    const house = document.getElementById("house_no").value;
    const village = document.getElementById("village_no").value;
    const prov = document.getElementById("province").value;
    const amphoe = document.getElementById("amphoe").value;
    const tambon = document.getElementById("tambon").value;

    const full = `${house} ‡∏´‡∏°‡∏π‡πà ${village} ‡∏ï.${tambon} ‡∏≠.${amphoe} ‡∏à.${prov}`;
    document.getElementById("full_address").value = full;
  });
</script>

